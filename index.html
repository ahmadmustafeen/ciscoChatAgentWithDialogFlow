<!DOCTYPE html>
<html lang="en">

<head>
    <link rel="stylesheet" href="./style.css" />
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <div class="chatBox">

        <div id="oldChat">
        </div>
        <input name="userQuery" id="userQuery" />
        <button onclick="sendMessage()">Sent</button>
    </div>




</body>

</html>
<!-- this is cdn of axios -->
<!-- <script src="https://unpkg.com/axios/dist/axios.min.js"></script> -->

<!-- comment this line and use cdn in server -->
<script src="./node_modules/axios/dist/axios.min.js"></script>

<script>
    const sendMessage = props => {
        const url = "https://dialogflow.googleapis.com/v2/projects/cisco-bot-ufmj/agent/sessions/5435:detectIntent";
        const token = "ya29.a0AfH6SMAfdO5AZ80IC7_URkkUPhuG4Xnd5II5dhLrmCv5bjZqwnp5oq2hItOueGpd8ijIfC3pHSGXCRBfufyDEdIzKifkQU-iCHP4DsI6CmlgYI_udVA1UQwjopH0MjETF87JzyIbJge1Or_M7Yg6-DAXJuDT"

        const message = document.getElementById('userQuery').value;
        const data = {
            query_input: {
                text: {
                    text: message,
                    language_code: "en-US"
                }
            }
        }
        // var xhr = new XMLHttpRequest();
        // xhr.open("POST", "https://dialogflow.googleapis.com/v2/projects/cisco-bot-ufmj/agent/sessions/5435:detectIntent", true);
        // xhr.setRequestHeader('Content-Type', 'application/json', 'bearer-token', 'ya29.a0AfH6SMAfdO5AZ80IC7_URkkUPhuG4Xnd5II5dhLrmCv5bjZqwnp5oq2hItOueGpd8ijIfC3pHSGXCRBfufyDEdIzKifkQU-iCHP4DsI6CmlgYI_udVA1UQwjopH0MjETF87JzyIbJge1Or_M7Yg6-DAXJuDT');
        // xhr.send(JSON.stringify(

        //     {
        //         "query_input": {
        //             "text": {
        //                 "text": message,
        //                 "language_code": "en-US"
        //             }
        //         }
        //     }

        // ));


        fetch(url, {
            method: 'POST',
            body: JSON.stringify({
                "query_input": {
                    "text": {
                        "text": message,
                        "language_code": "en-US"
                    }
                }
            }),
            headers: {
                'Content-Type': 'application/json',
                'Authorization': token
            }
        }).catch(sss => { console.log(sss); alert("Not Working" + sss) })

        const options = {
            headers:
                // { 'Authorization': 'Bearer ' + token },
                // { 'Access-Control-Allow-Origin': '*' },
                { 'crossDomain': true }

        };

        // axios.post(url, data, options).then(s => console.log(s)).catch(e => console.log("error:" + e))



    }

    function getAuthToken() {
        // POST Request (To get Access Token)
        var url = "https://dialogflow.googleapis.com/v2/projects/cisco-bot-ufmj/agent/sessions/5435:detectIntent"

        var postOptions = {
            'method': 'POST',
            'headers': {
                'Content-Type': 'application/json; charset=utf-8',
                'Authorization': 'ya29.a0AfH6SMAxYaE_RVRoAEQu6VVAynR0noknSCm6Nb0q-dkj4nVv94mJiRfmpL1QRLh6LRNo1YWfIuHlK_52jeY5QIhWqu09GLueFLeCtDGpjlKWQbE5XfKS4Uonejm6pm4kNyAZLn2kE-hx2ngkcgFpKREeFjLjRw'
                // 'Authorization': 'client_id:111793231984721478121, client_secret:MIIEvAIBADANBgkqhkiG9w0BAQEFAASCBKYwggSiAgEAAoIBAQC5nZYmtnv3NrWK\nwUasjpE/uQvu+MhPx2W3Vlb8IeTRFp/UExQkgUmniu73K7EeoctR4QgkZp7aQgRm\n+p8oAvDCDSoAJLI2jZAOvyTF1ogKdoP9S1znqkhs8jc6u5rsnNs+uLM+OFKQZAS7\nJqiBaHOlZ8Jg4EtHlKb0rYCsyvhdwaZorKGP7Z+UouXdqvXF+sxNAXbDVpqdTRFl\n3ixhvV2htRkDQzxsWPDjf9/tDx/YZnd5cnDx+fIs+yaJzMZRst232q+6AS0h8ULy\nuUqG0ep1WCOgEzEASgDa2Np4d1bblxuNaXWj5JuLUbJoX4INwDgvz715I0Bt7tyi\nITv9MasHAgMBAAECggEAEm+2Ics/Xes3tfwDlpEkmTU6m7ZnQxFVp5OyWSHOtfvu\nzSRF/GhBFhylJrTWx2mfpdbZta/huGEVSds74sAEBOpE0TXT47pE5EoVD3eDFLL3\n4jlRlYsi3Xtjg/htZ3IfDshOuW/jt4bPt30cAJqM3hGDy5aLs6Tuvl/bZ45ThBBU\nDxpAxQiyvBG3okpGHiTyRXbTWlr9NqCOTWPfBO0ljSmglZrXfBQpQM+2JGr5wFSN\n5agHBWqTvgjvxkGmqJqtUkGnblewhHMtQlVsmInpgR/Us0srINbL+ozIVVbZjCHL\nMTuMJt0PNokRTSnBNyesGSlq9F4QpZKaEA8pDQfPtQKBgQDtPLsdlQp2Z94fC3D2\nmWTke3pCS9h5pEchpqVKfWCCUgx5dTMqbMpw/GBFX6MHKgzKeVu7M0joGh0TkVY7\nY49r//Hq3WhgHQQ5hAg+RaYwMBERg6tQqPyj0e9IuEFWMcTgemSGdxOUE+qsLAxS\njf+griOIiF6DLCsBUGplzGWYUwKBgQDIS7AUiQlbSWudMXDwvou0Fk63/UAgegFv\nsy5nv/qFIhxfe12ZqQ0FiZrbVru1Ic2BQqIZFmMgRPudxKIApV67mNd/O69mWasT\nt01MH5DB4QUCD4L5zhe/fw98O+1KikR2nVLJcbWYcTKHb5XtsElSg3spSdf9RqvS\nkATvoLU7/QKBgD1PaagugWKyWzQ4t7vzTqDBzInfohVlwEBRGfyTRGLJo5GsGUoI\njZT/lD25hp9uXZniHTPXACuDvCn3cIquoz0tCy9Agx37wcC/f4XgaB+h/HdDSP3y\nfkA0HBv2CmSlPhUpbFtX4MZvE0HlrFWVfw/ekS5S1+Icgwy25JhkZ4kjAoGAYobI\n0PEwBxWwuByP//zbX/TxOBR9rPwXJMkxdJu9Miw7ZMScoG/GFglAgdDCeTFtk74h\nWtHmZQNJ+qu1PTgbx5BBwTas614Eh6hNf7qvTI/SFNdoiFVW3T41cdlQurAVSXvO\nM4WZ3KkiP/kl+UwUZWCD/yVx+AcBkoyBwRZ+0EkCgYB1RQf2fB1oCW+RSG2puB7K\nGnVi2wWawBMi5QsqM0gEfykGzXQY1X7Nxv3KCxwrba0xALc1DWyP2yNlT4meYSqr\nKlqya7fWC+NU+W9MkHdRm8Swlu3yUn8g6cn3Ei2/cn8iz4OrsNd3l2k40O+bojpi\ne1upNjigzU7vJpsXOUK9+g=='
            },
            'redirect': 'follow'
        };
        var authToken = fetch(url, postOptions);
    }
    getAuthToken()
</script>